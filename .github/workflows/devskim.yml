name: DevSkim Security Scan

on:
  push:
  pull_request:
    branches:
      - main
      - develop

jobs:
  devskim_scan:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2 #v2: v2.3.4 available

    - name: Setup .NET SDK
      run: |
        wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
        sudo dpkg -i packages-microsoft-prod.deb
        sudo apt-get update
        sudo apt-get install -y dotnet-sdk-5.0

    - name: Install DevSkim CLI
      run: dotnet tool install --global Microsoft.CST.DevSkim.CLI

    - name: Run DevSkim
      run: devskim analyze ./
  